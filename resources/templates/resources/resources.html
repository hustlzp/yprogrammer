{% extends 'base.html' %}

{% block page_id %}page-resources{% endblock %}
{% block page_title %}Resources{% endblock %}
{% block body %}

<script type="text/javascript">
$(function(){
   // collect resource by Ajax
   $('.btn-collect').one('click', function(){
      var r_id = $(this).data('resource-id');
      var url = "{% url 'collect_resource' %}";
      var btn_collect = $(this);

      ajax_collect_resource(url, r_id, function(){
         var collect_count = $(btn_collect).nextAll('.collect-count');
         $(btn_collect).parent().addClass('on');
         collect_count.text(parseInt(collect_count.text()) + 1);
      });
   });

   // discollect resource by Ajax
   $('.btn-discollect').one('click', function(){
      var r_id = $(this).data('resource-id');
      var url = "{% url 'discollect_resource' %}";
      var btn_discollect = $(this);

      ajax_collect_resource(url, r_id, function(){
         var collect_count = $(btn_discollect).nextAll('.collect-count');
         $(btn_discollect).parent().removeClass('on');
         collect_count.text(parseInt(collect_count.text()) - 1);
      });
   });
});
</script>

<div class="row">
   <div class="span8">
      <div class="page-header">
         <h3>资源 <small>新鲜不断出炉</small></h3>
      </div>

      {% include 'resources.tpl' with resources=resources %}
   </div>

   <div class="span4">
      <div class="sidebar-header">
         <h4>近期热门</h4>
      </div>
   </div>
</div>

{% endblock %}